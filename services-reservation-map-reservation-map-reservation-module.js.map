{"version":3,"sources":["./src/app/services/reservation/map-reservation/map-reservation.module.ts","./src/app/services/reservation/map-reservation/map-reservation.page.scss","./src/app/services/reservation/map-reservation/map-reservation.page.ts","./src/app/services/reservation/map-reservation/map-reservation-routing.module.ts","./src/app/services/reservation/map-reservation/map-reservation.page.html"],"names":[],"mappings":"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","file":"services-reservation-map-reservation-map-reservation-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MapReservationPageRoutingModule } from './map-reservation-routing.module';\n\nimport { MapReservationPage } from './map-reservation.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    MapReservationPageRoutingModule\n  ],\n  declarations: [MapReservationPage]\n})\nexport class MapReservationPageModule {}\n","export default \".map {\\n  width: 100%;\\n}\\n\\n#mapwize {\\n  position: absolute;\\n  top: 0;\\n  bottom: 0;\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL21hcC1yZXNlcnZhdGlvbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxXQUFBO0FBQ0o7O0FBQ0U7RUFDRSxrQkFBQTtFQUNBLE1BQUE7RUFDQSxTQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7QUFFSiIsImZpbGUiOiJtYXAtcmVzZXJ2YXRpb24ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1hcHtcbiAgICB3aWR0aDogMTAwJTtcbiAgfVxuICAjbWFwd2l6ZSB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogMDtcbiAgICBib3R0b206IDA7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICB9Il19 */\";","import { Component, ElementRef, OnInit ,AfterViewInit, HostListener, Inject, Injector} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { NavController } from '@ionic/angular';\nimport * as MapwizeUI from 'mapwize-ui'\nimport { RoomMocks } from 'src/mocks/room.mocks';\nimport { PlacesStyle, PlacesStyles, Reservation, Room } from 'src/model/room';\nimport { GeneralFunctions } from '../../general-functions';\nimport { RoomReservationService } from '../room-reservation/room-reservation.service';\n\n@Component({\n  selector: 'app-map-reservation',\n  templateUrl: './map-reservation.page.html',\n  styleUrls: ['./map-reservation.page.scss'],\n})\nexport class MapReservationPage implements OnInit {\n\n  constructor(\n    private roomReservationService : RoomReservationService,\n    private activatedRoute : ActivatedRoute,\n    private router : Router,\n    private htmlElement: ElementRef,\n    private navController: NavController,\n    private generalFunctions: GeneralFunctions\n  ) {}\n\n  rooms: Room[] = [];\n  currentRoom: Room;\n  reservations: Reservation[] = [];\n  currentDate;\n  mapWizeRoomStyle:any =[];\n\n  static readonly reservedColor = \"#ff0000\";\n  static readonly occupiedColor = \"#FF8C00\";\n  static readonly availableColor = \"#2E8B57\";\n  static readonly HideColor = \"#DCDCDC\";\n  static readonly placesToHide = [\n    '5d8a1921618902a02a7c7043',//TV SDR\n    '5d8a1921618902a02a7c7045',//TOILETTE\n    '5d8a1922618902a02a7c7047',//STOCK\n    '5d8a1922618902a02a7c7049',//TECHNIQUE/OPEN SPACE\n    '5d8a1922618902a02a7c704b',//DIRECTION\n    '5d8a1922618902a02a7c7051',//CUISINE\n    '5d8a1922618902a02a7c7055',//INFORMATIQUE\n    '5d8a1922618902a02a7c7057',//RECEPTION\n    '60003dc82be2a300165dafc3',//TV OS\n    '60003f2219e6de0016bb1eea',//ESCALIER E2\n    '60005f243781c50016f1e778',//ZONE SECURISEE\n    '6006ac00cfdbb200169e1312'//ESPACE VERT E2\n  ];\n\n  mapNavigation(htmlTag){\n    htmlTag.onclick = ()=>{\n      this.router.navigate(['/room-reservation'],{relativeTo : this.activatedRoute});\n    }\n  }\n\n  ngOnInit() {\n\n    this.currentDate  = new Date();\n    this.reservations = <Reservation[]> JSON.parse(localStorage.getItem('reservations'));\n\n    this.currentRoom = {\n      id: this.router.getCurrentNavigation().extras.state.id,\n      mapwizeId: this.router.getCurrentNavigation().extras.state.mapwizeId,\n      name: this.router.getCurrentNavigation().extras.state.name,\n      status: this.router.getCurrentNavigation().extras.state.status,\n      dateFin: this.router.getCurrentNavigation().extras.state.dateFin,\n      dateDebut: this.router.getCurrentNavigation().extras.state.dateDebut,\n    };\n    console.log(this.currentRoom)\n\n    this.rooms = this.roomReservationService.getrooms();\n    const options = {\n      apiKey: '6ee4fd2b3531c7b2609c77ca74ee5add',\n      centerOnVenueId: '5d8a191fb99124002d154c93',\n      preferredLanguage:'fr',\n      container: 'mapwize',\n      zoom: 19,\n      mainColor: '#ff0000',\n    }\n    let placesStyles: PlacesStyles = {};\n    this.rooms.map(room => {\n      let roomColor = '';\n      let beginReservationDate = new Date (room.dateDebut);\n      let endReservationDate = new Date (room.dateFin);\n      if( room.id == RoomMocks.busyRoomId ) {\n       roomColor = MapReservationPage.reservedColor;\n      }else if( room.id == RoomMocks.occupedRoomId ) {\n       roomColor = MapReservationPage.occupiedColor;\n      }else {\n        if( room.id == this.currentRoom.id) {\n          if(this.currentRoom.status === 'Libre'){\n            roomColor = MapReservationPage.availableColor;\n          }else{\n            roomColor = MapReservationPage.reservedColor;\n          }\n        }else if(beginReservationDate <= this.currentDate && endReservationDate > this.currentDate){\n          roomColor = MapReservationPage.reservedColor;\n        }else{\n          roomColor = MapReservationPage.availableColor;\n        }\n      }\n      placesStyles[room.mapwizeId] = <PlacesStyle>{\n        strokeColor:roomColor ,\n        strokeOpacity: 1,\n        strokeWidth: 2,\n        fillColor:roomColor,\n        fillOpacity: 0.7\n      }\n    });\n    let roomsToHide : PlacesStyles = {}\n    MapReservationPage.placesToHide.map(roomToHIde=>{\n      roomsToHide[roomToHIde] = <PlacesStyle>{\n        strokeColor:MapReservationPage.HideColor,\n        strokeOpacity: 1,\n        strokeWidth: 2,\n        fillColor:MapReservationPage.HideColor,\n        fillOpacity: 0.5\n      }\n    })\n    MapwizeUI.map(options).then((map) => {\n      this.generalFunctions.mapCss(map,'/room-reservation')\n      MapwizeUI.Api.getPlace(this.currentRoom.mapwizeId).then((place) => {\n        const position = {\n          latitude: place.marker.latitude,\n          longitude: place.marker.longitude,\n          floor: 2,\n        };\n        map.setPlaceStyles(placesStyles)\n        map.setPlaceStyles(roomsToHide)\n        map.addMarker(position)\n        .then(function(mapInstance){\n        })\n        .catch((err) => {\n          alert('Erreur probème serveur veuillez réssayer plus tard');\n        });\n      });\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MapReservationPage } from './map-reservation.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MapReservationPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MapReservationPageRoutingModule {}\n","export default \"<div class=\\\"map\\\">\\n    <div id=\\\"mapwize\\\"></div>\\n  </div>\\n  \";"],"sourceRoot":"webpack:///"}