{"version":3,"sources":["./src/app/services/parking/map-parking/map-parking-routing.module.ts","./src/app/services/parking/map-parking/map-parking.page.scss","./src/app/services/parking/map-parking/map-parking.page.html","./src/app/services/parking/map-parking/map-parking.page.ts","./src/app/services/parking/map-parking/map-parking.module.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACc;AAEH;AAEpD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,gEAAc;KAC1B;CACF,CAAC;IAMW,2BAA2B,SAA3B,2BAA2B;CAAG;AAA9B,2BAA2B;IAJvC,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,2BAA2B,CAAG;AAAH;;;;;;;;;;;;;AChBxC;AAAe,sEAAO,gBAAgB,GAAG,cAAc,uBAAuB,WAAW,cAAc,gBAAgB,iBAAiB,GAAG,6CAA6C,+eAA+e,E;;;;;;;;;;;;ACAvqB;AAAe,4HAA6D,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAd;AACL;AAG0B;AAC3C;AACe;AACR;AACY;IAQ9C,cAAc,4BAAd,cAAc;IAEzB,YACU,cAAsC,EACtC,cAA+B,EAC/B,MAAe,EACf,WAAuB,EACvB,aAA4B,EAC5B,gBAAkC;QALlC,mBAAc,GAAd,cAAc,CAAwB;QACtC,mBAAc,GAAd,cAAc,CAAiB;QAC/B,WAAM,GAAN,MAAM,CAAS;QACf,gBAAW,GAAX,WAAW,CAAY;QACvB,kBAAa,GAAb,aAAa,CAAe;QAC5B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAG5C,aAAQ,GAAU,EAAE,CAAC;QAErB,iBAAY,GAAyB,EAAE,CAAC;QAExC,qBAAgB,GAAM,EAAE,CAAC;QACzB,qBAAgB,GAAS,KAAK,CAAC;IAP5B,CAAC;IA6BJ,aAAa,CAAC,OAAO;QACnB,OAAO,CAAC,OAAO,GAAG,GAAE,EAAE;YACpB,iFAAiF;YACjF,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC;YACvD,uDAAuD;QACzD,CAAC;IACH,CAAC;IAGD,QAAQ;QACN,IAAI,CAAC,WAAW,GAAI,IAAI,IAAI,EAAE,CAAC;QAC/B,IAAI,CAAC,YAAY,GAA0B,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC,CAAC;QAEnG,IAAI,CAAC,mBAAmB,GAAG;YACzB,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;YACtD,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS;YACpE,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI;YAC1D,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM;YAC9D,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO;YAChE,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS;SACrE,CAAC;QACF,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;QAElD,IAAI,YAAY,GAAiB,EAAE,CAAC;QACpC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE;YAC/B,IAAI,iBAAiB,GAAG,EAAE,CAAC;YAC3B,IAAI,oBAAoB,GAAG,IAAI,IAAI,CAAE,YAAY,CAAC,SAAS,CAAC,CAAC;YAC7D,IAAI,kBAAkB,GAAG,IAAI,IAAI,CAAE,YAAY,CAAC,OAAO,CAAC,CAAC;YACzD,IAAI,YAAY,CAAC,EAAE,IAAI,oEAAY,CAAC,UAAU,EAAG;gBAChD,iBAAiB,GAAG,gBAAc,CAAC,aAAa,CAAC;aACjD;iBAAK,IAAI,YAAY,CAAC,EAAE,IAAI,oEAAY,CAAC,aAAa,EAAG;gBACzD,iBAAiB,GAAG,gBAAc,CAAC,aAAa,CAAC;aACjD;iBAAK;gBACJ,IAAI,YAAY,CAAC,EAAE,IAAI,IAAI,CAAC,mBAAmB,CAAC,EAAE,EAAE;oBAClD,IAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,KAAK,OAAO,EAAC;wBAC7C,iBAAiB,GAAG,gBAAc,CAAC,cAAc,CAAC;qBACnD;yBAAI;wBACH,iBAAiB,GAAG,gBAAc,CAAC,aAAa,CAAC;qBAClD;iBACF;qBAAK,IAAG,oBAAoB,IAAI,IAAI,CAAC,WAAW,IAAI,kBAAkB,GAAG,IAAI,CAAC,WAAW,EAAC;oBACzF,iBAAiB,GAAG,gBAAc,CAAC,aAAa,CAAC;iBAClD;qBAAI;oBACH,iBAAiB,GAAG,gBAAc,CAAC,cAAc,CAAC;iBACnD;aACF;YACD,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,GAAgB;gBAClD,WAAW,EAAC,iBAAiB;gBAC7B,aAAa,EAAE,CAAC;gBAChB,WAAW,EAAE,CAAC;gBACd,SAAS,EAAC,iBAAiB;gBAC3B,WAAW,EAAE,GAAG;aACjB;QACH,CAAC,CAAC,CAAC;QACH,IAAI,aAAa,GAAkB,EAAE;QACrC,gBAAc,CAAC,YAAY,CAAC,GAAG,CAAC,kBAAkB,GAAE;YAClD,aAAa,CAAC,kBAAkB,CAAC,GAAgB;gBAC/C,WAAW,EAAC,gBAAc,CAAC,SAAS;gBACpC,aAAa,EAAE,CAAC;gBAChB,WAAW,EAAE,CAAC;gBACd,SAAS,EAAC,gBAAc,CAAC,SAAS;gBAClC,WAAW,EAAE,GAAG;aACjB;QACH,CAAC,CAAC;QAEF,MAAM,OAAO,GAAG;YACd,MAAM,EAAE,kCAAkC;YAC1C,eAAe,EAAE,0BAA0B;YAC3C,iBAAiB,EAAC,IAAI;YACtB,SAAS,EAAE,SAAS;YACpB,IAAI,EAAE,EAAE;YACR,SAAS,EAAE,SAAS;SACrB;QACD,8CAAa,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE;YAClC,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,GAAG,EAAC,kBAAkB,CAAC;YACpD,8CAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;gBACxE,MAAM,QAAQ,GAAG;oBACf,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,QAAQ;oBAC/B,SAAS,EAAE,KAAK,CAAC,MAAM,CAAC,SAAS;oBACjC,KAAK,EAAE,CAAC;iBACT,CAAC;gBACF,GAAG,CAAC,cAAc,CAAC,YAAY,CAAC;gBAChC,GAAG,CAAC,cAAc,CAAC,aAAa,CAAC;gBACjC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC;qBACtB,IAAI,CAAC,UAAS,WAAW;gBAC1B,CAAC,CAAC;qBACD,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE;oBACb,KAAK,CAAC,oDAAoD,CAAC,CAAC;gBAC9D,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;CACF;AA9GiB,4BAAa,GAAG,SAAS,CAAC;AAC1B,4BAAa,GAAG,SAAS,CAAC;AAC1B,6BAAc,GAAG,SAAS,CAAC;AAC3B,wBAAS,GAAG,SAAS,CAAC;AACtB,2BAAY,GAAG;IAC7B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;IAC1B,0BAA0B;CAC3B,CAAC;;YAhDK,8FAAqB;YAHrB,8DAAc;YAAE,sDAAM;YADX,wDAAU;YAOrB,4DAAa;YACb,mEAAgB;;AAQZ,cAAc;IAL1B,+DAAS,CAAC;QACT,QAAQ,EAAE,iBAAiB;QAC3B,mFAAsC;;KAEvC,CAAC;GACW,cAAc,CAiI1B;AAjI0B;;;;;;;;;;;;;;;;;;;;;;;AChBc;AACM;AACF;AAEA;AAE8B;AAEvB;IAWvC,oBAAoB,SAApB,oBAAoB;CAAG;AAAvB,oBAAoB;IAThC,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,uFAA2B;SAC5B;QACD,YAAY,EAAE,CAAC,gEAAc,CAAC;KAC/B,CAAC;GACW,oBAAoB,CAAG;AAAH","file":"services-parking-map-parking-map-parking-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MapParkingPage } from './map-parking.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MapParkingPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MapParkingPageRoutingModule {}\n","export default \".map {\\n  width: 100%;\\n}\\n\\n#mapwize {\\n  position: absolute;\\n  top: 0;\\n  bottom: 0;\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL21hcC1wYXJraW5nLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFdBQUE7QUFDSjs7QUFDRTtFQUNFLGtCQUFBO0VBQ0EsTUFBQTtFQUNBLFNBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtBQUVKIiwiZmlsZSI6Im1hcC1wYXJraW5nLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tYXB7XG4gICAgd2lkdGg6IDEwMCU7XG4gIH1cbiAgI21hcHdpemUge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB0b3A6IDA7XG4gICAgYm90dG9tOiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgfSJdfQ== */\";","export default \"<div class=\\\"map\\\">\\n  <div id=\\\"mapwize\\\"></div>\\n</div>\\n\";","import { Component, ElementRef, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Parking, ParkingReservation } from 'src/model/parking';\nimport { PlacesStyle, PlacesStyles} from 'src/model/room';\nimport { ParkingServiceService } from '../gestion-parking/parking-service.service';\nimport * as MapwizeUI from 'mapwize-ui';\nimport { ParkingMocks } from 'src/mocks/parking.mocks';\nimport { NavController } from '@ionic/angular';\nimport { GeneralFunctions } from '../../general-functions';\n\n\n@Component({\n  selector: 'app-map-parking',\n  templateUrl: './map-parking.page.html',\n  styleUrls: ['./map-parking.page.scss'],\n})\nexport class MapParkingPage implements OnInit {\n\n  constructor(\n    private parkingService : ParkingServiceService,\n    private activatedRoute : ActivatedRoute,\n    private router : Router,\n    private htmlElement: ElementRef,\n    private navController: NavController,\n    private generalFunctions: GeneralFunctions\n  ) {}\n\n  parkings: any[] = [];\n  currentParkingPlace: Parking;\n  reservations: ParkingReservation[] = [];\n  currentDate;\n  mapWizeRoomStyle:any =[];\n  isUniverseOpened:boolean=false;\n\n\n  static readonly reservedColor = \"#ff0000\";\n  static readonly occupiedColor = \"#FF8C00\";\n  static readonly availableColor = \"#2E8B57\";\n  static readonly HideColor = \"#DCDCDC\";\n  static readonly placesToHide = [\n    '5d8a1921618902a02a7c7043',//TV SDR\n    '5d8a1921618902a02a7c7045',//TOILETTE\n    '5d8a1922618902a02a7c7047',//STOCK\n    '5d8a1922618902a02a7c7053',//SALLE DE REUNION\n    '5d8a1922618902a02a7c704f',//BOX\n    '5d8a1922618902a02a7c704d',//COMMERCIAL\n    '5d8a1922618902a02a7c7049',//TECHNIQUE/OPEN SPACE\n    '5d8a1922618902a02a7c704b',//DIRECTION\n    '5d8a1922618902a02a7c7051',//CUISINE\n    '5d8a1922618902a02a7c7055',//INFORMATIQUE\n    '60003dc82be2a300165dafc3',//TV OS\n    '60003f2219e6de0016bb1eea',//ESCALIER E2\n  ];\n\n  mapNavigation(htmlTag){\n    htmlTag.onclick = ()=>{\n      // this.router.navigate(['/gestion-parking'],{relativeTo : this.activatedRoute});\n      this.navController.navigateForward('/gestion-parking');\n      // this.navController.navigateRoot('/gestion-parking');\n    }\n  }\n\n\n  ngOnInit() {\n    this.currentDate  = new Date();\n    this.reservations = <ParkingReservation[]> JSON.parse(localStorage.getItem('ParkingReservations'));\n    \n    this.currentParkingPlace = {\n      id: this.router.getCurrentNavigation().extras.state.id,\n      mapwizeId: this.router.getCurrentNavigation().extras.state.mapwizeId,\n      name: this.router.getCurrentNavigation().extras.state.name,\n      status: this.router.getCurrentNavigation().extras.state.status,\n      dateFin: this.router.getCurrentNavigation().extras.state.dateFin,\n      dateDebut: this.router.getCurrentNavigation().extras.state.dateDebut,\n    };\n    this.parkings = this.parkingService.getParkings();\n\n    let placesStyles: PlacesStyles = {};\n    this.parkings.map(parkingPlace => {\n      let parkingPlaceColor = '';\n      let beginReservationDate = new Date (parkingPlace.dateDebut);\n      let endReservationDate = new Date (parkingPlace.dateFin);\n      if( parkingPlace.id == ParkingMocks.busyRoomId ) {\n       parkingPlaceColor = MapParkingPage.reservedColor;\n      }else if( parkingPlace.id == ParkingMocks.occupedRoomId ) {\n       parkingPlaceColor = MapParkingPage.reservedColor;\n      }else {\n        if( parkingPlace.id == this.currentParkingPlace.id) {\n          if(this.currentParkingPlace.status === 'Libre'){\n            parkingPlaceColor = MapParkingPage.availableColor;\n          }else{\n            parkingPlaceColor = MapParkingPage.reservedColor;\n          }\n        }else if(beginReservationDate <= this.currentDate && endReservationDate > this.currentDate){\n          parkingPlaceColor = MapParkingPage.reservedColor;\n        }else{\n          parkingPlaceColor = MapParkingPage.availableColor;\n        }\n      }\n      placesStyles[parkingPlace.mapwizeId] = <PlacesStyle>{\n        strokeColor:parkingPlaceColor ,\n        strokeOpacity: 1,\n        strokeWidth: 2,\n        fillColor:parkingPlaceColor,\n        fillOpacity: 0.7\n      }\n    });\n    let parkingToHide : PlacesStyles = {}\n    MapParkingPage.placesToHide.map(parkingPlaceToHIde=>{\n      parkingToHide[parkingPlaceToHIde] = <PlacesStyle>{\n        strokeColor:MapParkingPage.HideColor,\n        strokeOpacity: 1,\n        strokeWidth: 2,\n        fillColor:MapParkingPage.HideColor,\n        fillOpacity: 0.5\n      }\n    })\n\n    const options = {\n      apiKey: '6ee4fd2b3531c7b2609c77ca74ee5add',\n      centerOnVenueId: '5d8a191fb99124002d154c93',\n      preferredLanguage:'fr',\n      container: 'mapwize',\n      zoom: 19,\n      mainColor: '#ff0000',\n    }\n    MapwizeUI.map(options).then((map) => {\n      this.generalFunctions.mapCss(map,'/gestion-parking')\n      MapwizeUI.Api.getPlace(this.currentParkingPlace.mapwizeId).then((place) => {\n        const position = {\n          latitude: place.marker.latitude,\n          longitude: place.marker.longitude,\n          floor: 2,\n        };\n        map.setPlaceStyles(placesStyles)\n        map.setPlaceStyles(parkingToHide)\n        map.addMarker(position)\n        .then(function(mapInstance){\n        })\n        .catch((err) => {\n          alert('Erreur probème serveur veuillez réssayer plus tard');\n        });\n      });\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MapParkingPageRoutingModule } from './map-parking-routing.module';\n\nimport { MapParkingPage } from './map-parking.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    MapParkingPageRoutingModule\n  ],\n  declarations: [MapParkingPage]\n})\nexport class MapParkingPageModule {}\n"],"sourceRoot":"webpack:///"}